<div class="app-container">
  <header class="header">
    <img src="assets/logo.svg" alt="Trusty" class="logo-img" />
    <div class="tagline">Scopri in pochi secondi se il sito su cui vuoi fare acquisti è sicuro.</div>
  </header>

  <main class="main">
    <app-url-input
      [isLoading]="isLoading"
      (urlSubmit)="onCheckUrl($event)"
      (helpClick)="showHelpModal = true"
      (infoClick)="showInfoModal = true"
    />

    @if (!isLoading && !result && !error) {
      <div class="empty-state">
        <div class="shield-container">
          <svg class="shield-icon" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path class="shield-body" d="M32 4L8 14V30C8 46.5 18.5 56.5 32 60C45.5 56.5 56 46.5 56 30V14L32 4Z"
                  stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
            <path class="checkmark" d="M22 32L29 39L42 26"
                  stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <p class="empty-state-text">Inserisci un link per iniziare la verifica</p>
      </div>
    }

    @if (isLoading) {
      <app-loading message="Analisi in corso" />
    }

    @if (result && !isLoading) {
      <app-trust-result [result]="result" />
      <app-share-buttons [result]="result" />
    }

    @if (error && !isLoading) {
      <div class="error-message">
        <span class="error-icon">⚠️</span>
        <span>{{ error }}</span>
      </div>
    }
  </main>

  <footer class="footer">
    <p class="disclaimer">
      Trusty fornisce un punteggio indicativo generato automaticamente da algoritmi su dati pubblici. Tale valutazione rappresenta un'opinione tecnica e non costituisce prova di legittimità o illegittimità. L'uso del servizio implica l'accettazione che i risultati potrebbero essere incompleti o errati. Trusty non è responsabile per le decisioni d'acquisto né per eventuali danni reputazionali derivanti dall'interpretazione automatizzata.
    </p>

    <button class="report-btn" (click)="showReportModal = true">
      Segnala un'anomalia
    </button>
  </footer>

  @if (!isInstalled) {
    <button class="floating-install-btn" (click)="installApp()" title="Installa App">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
        <polyline points="7 10 12 15 17 10"/>
        <line x1="12" y1="15" x2="12" y2="3"/>
      </svg>
      <span class="floating-install-tooltip">Installa App</span>
    </button>
  }

  @if (showInfoModal) {
    <app-info-modal (close)="showInfoModal = false" />
  }

  @if (showHelpModal) {
    <app-help-modal (close)="showHelpModal = false" />
  }

  @if (showReportModal) {
    <app-report-modal (close)="showReportModal = false" />
  }
</div>
